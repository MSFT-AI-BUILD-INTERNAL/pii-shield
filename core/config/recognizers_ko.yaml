# Korean PII Recognizers Configuration
# Reference: https://microsoft.github.io/presidio/analyzer/recognizer_registry_provider/

global_regex_flags: 26  # re.IGNORECASE | re.MULTILINE | re.DOTALL

supported_languages:
  - ko

recognizers:
  # ==================== Predefined Recognizers ====================
  
  - name: CreditCardRecognizer
    type: predefined
    supported_languages:
      - language: ko
        context: [신용카드, 카드번호, 카드, credit, card]

  # EmailRecognizer disabled - use KrEmailRecognizer instead for consistent KR_EMAIL entity
  # - name: EmailRecognizer
  #   type: predefined
  #   supported_languages:
  #     - language: ko
  #       context: [이메일, 메일, email, e-mail]

  - name: IpRecognizer
    type: predefined
    supported_languages:
      - language: ko

  - name: UrlRecognizer
    type: predefined
    supported_languages:
      - language: ko

  - name: SpacyRecognizer
    type: predefined
    supported_languages:
      - language: ko

  # ==================== Korean Custom Recognizers ====================
  
  # Korean Resident Registration Number (주민등록번호)
  - name: KrResidentRegistrationNumberRecognizer
    type: custom
    supported_entity: KR_SSN
    supported_languages:
      - language: ko
        context: [주민등록번호, 주민번호, 주민, resident registration, rrn]
    patterns:
      - name: "Korean RRN with hyphen"
        regex: "\\d{6}-\\d{7}"
        score: 0.9
      - name: "Korean RRN without hyphen"
        regex: "(?<!\\d)\\d{2}[0-1]\\d[0-3]\\d[1-4]\\d{6}(?!\\d)"
        score: 0.7

  # Korean Phone Number (휴대폰/전화번호)
  - name: KrPhoneNumberRecognizer
    type: custom
    supported_entity: KR_PHONE_NUMBER
    supported_languages:
      - language: ko
        context: [전화번호, 휴대폰, 핸드폰, 연락처, phone, mobile, tel]
    patterns:
      - name: "Korean Mobile with hyphen"
        regex: "01[0-9]-\\d{3,4}-\\d{4}"
        score: 0.85
      - name: "Korean Mobile without hyphen"
        regex: "(?<!\\d)01[0-9]\\d{7,8}(?!\\d)"
        score: 0.6
      - name: "Korean Landline with hyphen"
        regex: "0\\d{1,2}-\\d{3,4}-\\d{4}"
        score: 0.8

  # Korean Bank Account (계좌번호)
  - name: KrBankAccountRecognizer
    type: custom
    supported_entity: KR_BANK_ACCOUNT
    supported_languages:
      - language: ko
        context: [계좌번호, 계좌, 은행, bank account, account number, 입금, 출금, 환불]
    patterns:
      - name: "Korean Bank Account"
        regex: "\\d{3,4}-\\d{2,4}-\\d{4,6}"
        score: 0.6

  # Korean Name (이름)
  # 성씨 기반 패턴 + Context 조합으로 정밀도 향상
  # 한국 주요 성씨: 김이박최정강조윤장임한오서신권황안송류전홍
  - name: KrNameRecognizer
    type: custom
    supported_entity: KR_NAME
    supported_languages:
      - language: ko
        context: [이름, 성명, 고객님, 담당자, 님께서]
    patterns:
      # ===== 최고 우선순위: 안녕하세요 + 이름 + 입니다 패턴 (score 0.95) =====
      
      # 안녕하세요, 성씨+이름(1-4글자)+입니다 (안녕하세요, 김철수입니다)
      - name: "Korean Name after 안녕하세요 + 입니다"
        regex: "(?<=안녕하세요,\\s)(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,4}(?=입니다)"
        score: 0.95

      # 안녕하세요, 이름(1-4글자)+직급+입니다 (안녕하세요, 김부장입니다)
      - name: "Korean Name + Title after 안녕하세요"
        regex: "(?<=안녕하세요,\\s)([가-힣]{1,4})(?=\\s?(사장|부사장|전무|상무|이사|부장|차장|과장|대리|주임|사원|매니저|팀장|실장|본부장|센터장|원장|소장|국장|처장|청장|장관|총장|학장|교장|교수|박사|석사|선생|코치|감독|기사|기장|선장|대표|회장|총재|의장|위원장)입니다)"
        score: 0.95

      # 안녕하세요, 이름(1-4글자)+직업+입니다 (안녕하세요, 김변호사입니다)
      - name: "Korean Name + Profession after 안녕하세요"
        regex: "(?<=안녕하세요,\\s)([가-힣]{1,4})(?=\\s?(변호사|회계사|세무사|법무사|변리사|노무사|관세사|감정사|평가사|의사|치과의사|한의사|약사|간호사|수의사|검사|판사|경찰|소방관|군인|공무원|교사|강사|기자|작가|화가|음악가|배우|가수|아나운서|기술사|건축사|측량사)입니다)"
        score: 0.95

      # ===== 높은 우선순위: 성씨 기반 패턴 (score 0.9) =====
      
      # 성씨+이름+입니다 (김철수입니다) - 이름은 1-2글자만
      - name: "Korean Name surname + 입니다"
        regex: "(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,2}(?=입니다)"
        score: 0.9

      # Case 3 해결: 성씨+이름 + 공백 + 고객님 (정약용 고객님)
      - name: "Korean Name surname + 고객님"
        regex: "(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,3}(?=\\s고객님)"
        score: 0.9

      # Case 2 해결: 담당자 + 성씨+이름 (담당자 최지원)
      - name: "Korean Name after 담당자 with surname"
        regex: "(?<=담당자\\s)(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,2}"
        score: 0.9

      # ===== 중간 우선순위: 성씨 기반 일반 패턴 (score 0.85) =====
      
      # 성씨+이름+님 (김철수님, 홍길동님)
      - name: "Korean Name surname + 님"
        regex: "(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,3}(?=님)"
        score: 0.85

      # 성씨+이름+씨 (김철수씨)
      - name: "Korean Name surname + 씨"
        regex: "(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,2}(?=씨)"
        score: 0.85

      # 배송 담당 + 성씨+이름 (배송 담당 이순신)
      - name: "Korean Name after 배송 담당"
        regex: "(?<=배송 담당\\s)(김|이|박|최|정|강|조|윤|장|임|한|오|서|신|권|황|안|송|류|전|홍|배|백|허|유|남|심|노|하|곽|성|차|주|우|구|민|진|지|채|원|천|방|공|현|문|양|손|나|여|함|변|염|석|선|설|길|연|명|반|왕|금|옥|육|인|맹|피|제|모|어|탁|봉|빈|편|경|소)[가-힣]{1,2}"
        score: 0.85

      # ===== 낮은 우선순위: 호칭 패턴 (score 0.7) =====
      
      # 어이 + 이름 (어이 철수)
      - name: "Korean Name after 어이"
        regex: "(?<=어이\\s)([가-힣]{2,4})"
        score: 0.7

      # 이봐요 + 이름 (이봐요 영희)
      - name: "Korean Name after 이봐요"
        regex: "(?<=이봐요\\s)([가-힣]{2,4})"
        score: 0.7

      # ===== 특수 케이스: 역사적 인물/별칭 (score 0.8) =====
      
      # 세종대왕, 신사임당 등 역사적 인물 + 님
      - name: "Korean Historical Names + 님"
        regex: "(세종대왕|신사임당|이순신|강감찬|을지문덕|광개토대왕|왕건|이성계)(?=님)"
        score: 0.8

  # Korean Email (이메일)
  - name: KrEmailRecognizer
    type: custom
    supported_entity: KR_EMAIL
    supported_languages:
      - language: ko
        context: [이메일, 메일, email, e-mail, 메일 주소]
    patterns:
      - name: "Email Pattern"
        regex: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
        score: 0.95
