# English PII Recognizers Configuration
# Reference: https://microsoft.github.io/presidio/analyzer/recognizer_registry_provider/

global_regex_flags: 26  # re.IGNORECASE | re.MULTILINE | re.DOTALL

supported_languages:
  - en

recognizers:
  # ==================== Predefined Recognizers ====================
  
  - name: CreditCardRecognizer
    type: predefined
    supported_languages:
      - language: en
        context: [credit, card, visa, mastercard, cc, amex, discover, jcb, diners, maestro]

  - name: EmailRecognizer
    type: predefined
    supported_languages:
      - language: en
        context: [email, e-mail, mail, contact]

  - name: IbanRecognizer
    type: predefined
    supported_languages:
      - language: en

  - name: IpRecognizer
    type: predefined
    supported_languages:
      - language: en
        context: [ip, address, ip address]

  - name: PhoneRecognizer
    type: predefined
    supported_languages:
      - language: en
        context: [phone, call, contact, mobile, cell, tel, telephone]

  - name: UrlRecognizer
    type: predefined
    supported_languages:
      - language: en
        context: [url, website, link, site, http]

  - name: SpacyRecognizer
    type: predefined
    supported_languages:
      - language: en

  - name: DateRecognizer
    type: predefined
    supported_languages:
      - language: en

  # ==================== Custom Recognizers ====================
  
  # US Phone Number - Enhanced pattern for xxx-xxx-xxxx format
  - name: UsPhoneRecognizer
    type: custom
    supported_entity: PHONE_NUMBER
    supported_languages:
      - language: en
        context: [phone, call, contact, mobile, cell, tel, telephone, number]
    patterns:
      - name: "US Phone with hyphens"
        regex: "\\b\\d{3}[-.]\\d{3}[-.]\\d{4}\\b"
        score: 0.7
      - name: "US Phone with area code"
        regex: "\\b1?[-.]?\\d{3}[-.]\\d{3}[-.]\\d{4}\\b"
        score: 0.75
      - name: "US Toll-free"
        regex: "\\b1[-.]?8[0-9]{2}[-.]\\d{3}[-.]\\d{4}\\b"
        score: 0.85

  # US Social Security Number
  - name: UsSsnRecognizer
    type: custom
    supported_entity: US_SSN
    supported_languages:
      - language: en
        context: [ssn, social security, social security number]
    patterns:
      - name: "SSN with hyphens"
        regex: "\\b\\d{3}[-]\\d{2}[-]\\d{4}\\b"
        score: 0.85
      - name: "SSN without hyphens"
        regex: "\\b\\d{9}\\b"
        score: 0.3
